# Nessus-Vulnerability-Management

<br>
<br>
<br>

# Introduction:

Nessus is a vulnerability scanner used to identify and assess security vulnerabilities in computer systems and networks. It was developed by **Tenable** and is widely used by security professionals and penetration testers to evaluate the security posture of an organization.

Nessus can scan for vulnerabilities in operating systems, applications, services, and network devices. It uses a database of known security gaps to identify weaknesses in systems and provides detailed information on how to mitigate them. Nessus is widely used for remote scanning, comprehensive scanning, reporting, policy compliance, and integration. 

<br>
<br>

# Purpose: 

The purpose of this project was for me to gain hands-on experience with Nessus. In this project, I used Nessus to scan for vulnerabilities in a Windows 10 operating system. I then performed remediation techniques to reduce the vulnerabilities in order for the system to be at an acceptable state.

<br>
<br>
<br>

# Technical Tools used for this project

- Nessus
- VMWare WorkStation
- Windows 10 OS


<br>
<br>
<br>

# Windows Virtual Machine Setup

The first thing I did was install the Windows 10 ISO file from the Microsoft website. I used Windows 10 as my operating system for this lab. This will allow me to install Windows 10 on VMWare Workstation.

![Capture1](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/76556266-af3f-4a8f-8aa6-26198b312107)

<br>
<br>
<br>
<br>

After installing the Windows 10 ISO file. I opened VMWare Workstation and configured the settings before creating the VM.  I changed the network adapter settings to Bridged which will make it easier for the virtual machine to communicate with the local machine.  

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/872dbe98-cecb-4570-a8b9-1c1d3caf9675" alt="Windows 10 VM Setup" width="500" height="500">

<br>
<br>
<br>
<br>

After finishing the Windows VM setup, I logged into the VM and opened the command prompt to ensure that the VM can communicate with the local machine.  I first used the ipconfig command to get the IP address before testing the system’s connectivity. After doing this, I noticed that there wasn't any communication betewwn the VM and the local machine. So I configured the firewall settings. 

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/01f626a2-a1eb-46f0-a3a5-eb9f7e66ab51" alt="Windows 10 VM Setup" width="450" height="450">

<br>
<br>
<br>

After configuring the firewall settings, I went back to the command prompt to test the connection and saw that the virtual machine was finally able to communicate with the local machine. 

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/8b1db771-d714-416f-96d8-5b17b691fc1d " alt="Connection Test" width="500" height="350">

<br>
<br>
<br>

# Nessus Vulnerability Scan

I scanned the virtual machine using the IP address I collected from the command prompt. I clicked on "Create a new scan" and landed on this page. As you can see, Nessus allows you to perform different types of vulnerability checks such as web application tests, mobile device scans, and network scans.

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/26a39a7c-dff9-43d8-beab-d30820370c1f" alt="Nessus" width="600" height="420">

 <br>
<br>
<br>

On this page I created a new scan and entered the IP address of the VM in the Targets section.

![Capture18](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/0857e8e5-0967-4694-9588-2957f52cc928)

<br>
<br>
<br>

After starting the first scan, I noticed that the scanner detected a total of 32 vulnerabilites. 1 of the vulnerabilites was marked at a medium level rank. This was while the scanner was still running. 

![Capture20](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/78712e77-4668-464e-961f-841874273d55)

This is the completed scan.

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/7833cfac-2161-4623-8873-23e2f5efc6fb" alt="First Scan Complete" width="600" height="400">

<br>
<br>
<br>

I took some time to do research on the highest ranked vulnerability. The vulnerability said SMB “Signing not required.” SMB (Server Message Block) signing is a security feature in Windows that ensures the authenticity and integrity of SMB packets sent between network devices. When SMB signing is enabled, a digital signature is added to the packets, preventing attackers from intercepting or modifying the data. If SMB signing is not required, it means that the network devices are not configured to enforce SMB signing on all SMB packets. This can potentially make the network vulnerable to man-in-the-middle (MITM) attacks, where an attacker intercepts SMB packets and modifies them without detection.

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/42dfc778-1c3f-4e10-a421-280bb572b9b8" alt="First Scan Research" width="600" height="450">


<br>
<br>
<br>

# Credentialed Scan

A credentialed scan in Nessus refers to a scan that is performed with administrative or privileged credentials on the target system. By using privileged credentials, the scanner can access additional information and perform more in-depth testing of the target system, which can help identify potential vulnerabilities that may not be visible during an non-credentialed scan.

In this step, I configured the VM for the next scan which will be a credentialed scan. I went to Services on my VM and enabled the Remote Registry which allowed Nessus to connect to the VM’s registry and search for any insecure configurations.

I enabled Remote Registry to allow Nessus to scan for security gaps in the registry. 

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/17a9ab15-db76-4ac6-8afb-8a76550d12d0" alt="Windows 10 VM Setup" width="550" height="450">

<br>
<br>
<br>
<br>

I added a key to allow a remote account to connect to the VM. I performed this step to further disable user accounts controls. I did this by adding a DWORD value called "LocalAccountTokenFilterPolicy" and giving it a value of 1.

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/5baff5e8-fd5a-44bb-9547-e2c1b2dfdf96 " alt="Registry Editor" width="550" height="400">

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/bf96347e-633e-4ed5-8ae5-6a7bda2206d0" alt="Registry Editor" width="300" height="200">

<br>
<br>
<br>

After configuring the settings in the registry editor, I restarted the VM and went back to my local machine to perfom a credentialed scan on Nessus.

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/a9a05168-7e09-40d3-89e3-edbb79ce530d" alt="Credentialed Scan" width="670" height="380">

<br>
<br>
<br>

The credentialed scan performed a more in-depth vulnerability check and discovered more security vulnerabilities. Some of which are ranked high and critical. 

![Capture37](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/819d6f22-b7c5-4773-bfe5-197d261aec7d)


<br>
<br>
<br>


This is an image of the vulnerabilities after the credential scan.

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/936817a3-d022-4c1d-b2ef-2ef90a28164b" alt="Credentialed Scan" width="640" height="400">
<br>
<br>
<br>

This is a list of the high severity vulnerabilities. I clicked on one of them to get more information. 

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/410f897e-b822-438f-bf1d-148d09822432" alt="High Ranked Vulnerabilities" width="640" height="400">

<br>
<br>
<br>

The vulnerability stated that the operating system has an outdated version of Windows Defender and needs to be updated. Ignoring this can leave the operating system exploitable to attackers, allowing them to cause to the system. It's always recommended for organizations to ensure that systems fully updates and have the latest patches in order to avoid security risks.

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/b8614565-32b0-430c-86b0-b3359608a5e5" alt="Vulnerability Info" width="640" height="400">


<br>
<br>
<br>

Here is a list of solutions that Nessus recommended for the vulnerabilities.

![Capture41](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/d14a399d-3ff7-49fd-bb40-cb8d2e311a22)

<br>
<br>
<br>

I noticed that some vulnerabilities were ranked as critical so I decided to get more information.

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/9f89ff9c-5f30-4cb0-8ce3-8820147ad67e" alt="Vulnerability Info" width="630" height="450">


<br>
<br>
<br>

This vulnerability says that Windows VM was missing a security update which was leaving the system exposed to threats.

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/46e97e08-1267-4ff3-a018-b75321837f23" alt="Vulnerability Info" width="600" height="450">

<br>
<br>
<br>

# Deprecated Software Installation

In this step, I installed an outdated version of Firefox for the next credentialed scan. This was a test to see what other vulnerabilities Nessus can detect.

![Capture51](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/dab74a00-6c89-41bd-b11e-03da6735c327)

<br>
<br>
<br>

This was after installing the old version of Mozilla Firefox. Just by the look of the opening page, you can tell that it is outdated.
<br>
<br>
<br>

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/80315c3d-cdfa-40fb-98ea-8ef72b533177" alt="Deprecated Software Install" width="500" height="350">

<br>
<br>
<br>

I then started another credentialed scan on the virtual machine. And just as I expected, Nessus has discovered more vulnerabilities due to the outdated Mozilla Firefox that I installed. 

![Capture55](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/35bf8842-b232-4e4a-9eb4-87a208219e22)

<br>
<br>
<br>

Just as I predicted, Nessus identified more security vulnerabilities that were ranked as critical. 

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/5a4f5a7e-7692-466d-a3ce-b072b309c214" alt="Vuln. Scan" width="700" height="400">

<br>
<br>
<br>

This is more infomation about one of the critical vulnerabilities in the system. Nessus identified that the Mozilla Firefox software is outdated and can lead to application crashes and even remote code execution. 

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/51297330-ac74-408f-a8e2-9dd2a18f2c27" alt="Vuln. Scan" width="600" height="400">

<br>
<br>
<br>


# Remediation Process

For the remediation process, I first uninstalled the outdated Firefox browser.

 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/08338592-103c-418b-8372-2e86cd980326" alt="Remediation Process" width="600" height="500">

 <br>
 <br>
 <br>

I went to Windows settings on the VM to check for any missing updates in the operating system. After that, I ran updates on the virtual machine for the remediation process.

<img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/a0996b36-4b0b-498d-97e5-13fc4c204ccc" alt="Remediation" width="500" height="400">



 <img src="https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/b1500f21-5bb5-4b81-a354-9fcbe48eb3b8" alt="Remediation" width="500" height="400">


<br>
<br>
<br>

After the system finished updating, I started a final credentialed scan for the project. I expected Nessus to scan for less vulnerabilities than the last scan due to the Windows updates on the virtual machine.

As expected, Nessus discovered less vulnerabilities compared to the last scan due to the remediation process. There were less vulnerabilites ranked as high or critical.

![Capture69](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/55816185-6b2b-4c65-8505-29d4c3b74aa9)

<br>
<br>
<br>

# Comparison

Here is a comparison of the scans.
<br>
<br>
<br>

- First Scan:

![Capture20](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/0a64fa38-94cc-4c5d-9a34-8968bd0a48b4)

<br>
<br>
<br>

- Credentialed Scan: 

![Capture37](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/fe20f721-4ce0-460d-94b6-9959268f5bee)

<br>
<br>
<br>

- Scan after installing Outdated Software:

![Capture55](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/b056bc23-bb3a-496d-a257-6c94b74989b1)

<br>
<br>
<br>

- Scan After Remediation Process:

![Capture68](https://github.com/obi298/Nessus-Vulnerability-Management/assets/90945162/890ae3e0-6756-4461-9980-1e202ace6b5d)

<br>
<br>
<br>
<br>

# Conclusion: 

Nessus is a powerful vulnerability scanner that can be highly beneficial for organizations in several ways:

- **Vulnerability detection:** Nessus is used to scan and detect vulnerabilities in an organization's network, servers, and applications. It helps in providing detailed reports on potential security risks. This helps organizations identify and fix vulnerabilities before they can be exploited by attackers.

- **Compliance:** Nessus can help organizations comply with various security regulations such as PCI-DSS, HIPAA, and ISO 27001 by scanning and reporting on compliance-related issues.

- **Risk Management:** Nessus can help organizations prioritize their security efforts by identifying and reporting on the most critical vulnerabilities. This can help organizations allocate resources and focus their efforts on the most important issues.

- **Cost-effective:** Nessus is cost-effective compared to other vulnerability management solutions in the market. Organizations can choose to purchase a license for Nessus and run it on-premises or use the cloud-based version to manage vulnerabilities without incurring additional costs.

- **Integrations:** Nessus can be integrated with other security tools such as SIEM, IAM, and GRC solutions, making it easier for organizations to manage their security operations and maintain visibility across their entire infrastructure.


Overall, Nessus is a powerful vulnerability scanner that can help organizations improve their security posture and comply with business requirements.
This was a very fun lab and I gained a better understanding of vulnerability scanning, researching, and remediation. This project opened my mind about the many vulnerabilities that lie within our devices. It is always important to keep your devices up-to-date and secure.

# Resource:

www.tenable.com




















